2025-08-24 19:15:30,765 - INFO - 随机种子已固定：42
2025-08-24 19:15:32,358 - INFO - 初始化数据迭代器耗时: 0:00:00
2025-08-24 19:15:32,358 - INFO - 训练集批次：1407，验证集批次：79，测试集批次：79
2025-08-24 19:15:32,358 - INFO - 从头训练（使用预训练模型初始化）
2025-08-24 19:15:32,358 - INFO - 
===== 开始训练 =====
2025-08-24 19:15:32,363 - INFO - 
Epoch [1/3]
2025-08-24 19:15:32,988 - INFO - 紧急保存断点至：./saved_models/checkpoints/emergency.pt
2025-08-24 19:15:32,988 - ERROR - 训练中断：输入数据设备错误：cuda:0，已保存紧急断点
Traceback (most recent call last):
  File "/root/myproject/train.py", line 167, in train
    assert batch["input_ids"].device == config.device, f"输入数据设备错误：{batch['input_ids'].device}"
AssertionError: 输入数据设备错误：cuda:0
2025-08-24 19:15:32,989 - INFO - TensorBoard writer已关闭
2025-08-24 19:16:28,059 - INFO - 随机种子已固定：42
2025-08-24 19:16:29,532 - INFO - 初始化数据迭代器耗时: 0:00:00
2025-08-24 19:16:29,532 - INFO - 训练集批次：1407，验证集批次：79，测试集批次：79
2025-08-24 19:16:29,532 - INFO - 从头训练（使用预训练模型初始化）
2025-08-24 19:16:29,532 - INFO - 
===== 开始训练 =====
2025-08-24 19:16:29,537 - INFO - 
Epoch [1/3]
2025-08-24 19:16:36,259 - INFO - 评估完成 - 平均损失: 2.2278, 准确率: 0.1955
2025-08-24 19:16:36,886 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:16:36,886 - INFO - Iter:      0, LR: 0.000050, Batch Train Loss:   2.5, Batch Train Acc:  7.81%, Val Loss:   2.2, Val Acc: 19.55%, Time: 0:00:07 *
2025-08-24 19:16:59,971 - INFO - 评估完成 - 平均损失: 0.3395, 准确率: 0.9010
2025-08-24 19:17:01,474 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:17:01,475 - INFO - Iter:    100, LR: 0.000049, Batch Train Loss:  0.48, Batch Train Acc: 88.28%, Val Loss:  0.34, Val Acc: 90.10%, Time: 0:00:32 *
2025-08-24 19:17:24,659 - INFO - 评估完成 - 平均损失: 0.3080, 准确率: 0.9064
2025-08-24 19:17:26,242 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:17:26,243 - INFO - Iter:    200, LR: 0.000048, Batch Train Loss:  0.37, Batch Train Acc: 89.84%, Val Loss:  0.31, Val Acc: 90.64%, Time: 0:00:57 *
2025-08-24 19:17:49,470 - INFO - 评估完成 - 平均损失: 0.2735, 准确率: 0.9147
2025-08-24 19:17:50,961 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:17:50,963 - INFO - Iter:    300, LR: 0.000046, Batch Train Loss:  0.22, Batch Train Acc: 92.97%, Val Loss:  0.27, Val Acc: 91.47%, Time: 0:01:21 *
2025-08-24 19:18:14,224 - INFO - 评估完成 - 平均损失: 0.2700, 准确率: 0.9144
2025-08-24 19:18:15,717 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:18:15,718 - INFO - Iter:    400, LR: 0.000045, Batch Train Loss:  0.21, Batch Train Acc: 92.97%, Val Loss:  0.27, Val Acc: 91.44%, Time: 0:01:46 *
2025-08-24 19:18:38,969 - INFO - 评估完成 - 平均损失: 0.2458, 准确率: 0.9200
2025-08-24 19:18:40,586 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:18:40,587 - INFO - Iter:    500, LR: 0.000044, Batch Train Loss:  0.26, Batch Train Acc: 92.19%, Val Loss:  0.25, Val Acc: 92.00%, Time: 0:02:11 *
2025-08-24 19:19:03,865 - INFO - 评估完成 - 平均损失: 0.2338, 准确率: 0.9220
2025-08-24 19:19:05,318 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:19:05,319 - INFO - Iter:    600, LR: 0.000043, Batch Train Loss:  0.25, Batch Train Acc: 92.19%, Val Loss:  0.23, Val Acc: 92.20%, Time: 0:02:36 *
2025-08-24 19:19:28,639 - INFO - 评估完成 - 平均损失: 0.2219, 准确率: 0.9277
2025-08-24 19:19:30,369 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:19:30,370 - INFO - Iter:    700, LR: 0.000042, Batch Train Loss:  0.25, Batch Train Acc: 92.97%, Val Loss:  0.22, Val Acc: 92.77%, Time: 0:03:01 *
2025-08-24 19:19:53,800 - INFO - 评估完成 - 平均损失: 0.2168, 准确率: 0.9291
2025-08-24 19:19:55,300 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:19:55,301 - INFO - Iter:    800, LR: 0.000041, Batch Train Loss:  0.21, Batch Train Acc: 96.09%, Val Loss:  0.22, Val Acc: 92.91%, Time: 0:03:26 *
2025-08-24 19:20:18,633 - INFO - 评估完成 - 平均损失: 0.2062, 准确率: 0.9319
2025-08-24 19:20:20,126 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:20:20,126 - INFO - Iter:    900, LR: 0.000039, Batch Train Loss:  0.32, Batch Train Acc: 90.62%, Val Loss:  0.21, Val Acc: 93.19%, Time: 0:03:51 *
2025-08-24 19:20:43,587 - INFO - 评估完成 - 平均损失: 0.2122, 准确率: 0.9291
2025-08-24 19:20:43,589 - INFO - Iter:   1000, LR: 0.000038, Batch Train Loss:  0.24, Batch Train Acc: 92.97%, Val Loss:  0.21, Val Acc: 92.91%, Time: 0:04:14 
2025-08-24 19:21:06,917 - INFO - 评估完成 - 平均损失: 0.1991, 准确率: 0.9313
2025-08-24 19:21:08,407 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:21:08,408 - INFO - Iter:   1100, LR: 0.000037, Batch Train Loss: 0.088, Batch Train Acc: 96.88%, Val Loss:   0.2, Val Acc: 93.13%, Time: 0:04:39 *
2025-08-24 19:21:31,662 - INFO - 评估完成 - 平均损失: 0.1945, 准确率: 0.9358
2025-08-24 19:21:33,140 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:21:33,141 - INFO - Iter:   1200, LR: 0.000036, Batch Train Loss:  0.28, Batch Train Acc: 92.19%, Val Loss:  0.19, Val Acc: 93.58%, Time: 0:05:04 *
2025-08-24 19:21:56,413 - INFO - 评估完成 - 平均损失: 0.1907, 准确率: 0.9360
2025-08-24 19:21:58,054 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:21:58,055 - INFO - Iter:   1300, LR: 0.000035, Batch Train Loss:  0.12, Batch Train Acc: 94.53%, Val Loss:  0.19, Val Acc: 93.60%, Time: 0:05:29 *
2025-08-24 19:22:21,399 - INFO - 评估完成 - 平均损失: 0.1995, 准确率: 0.9344
2025-08-24 19:22:21,400 - INFO - Iter:   1400, LR: 0.000033, Batch Train Loss:  0.16, Batch Train Acc: 96.88%, Val Loss:   0.2, Val Acc: 93.44%, Time: 0:05:52 
2025-08-24 19:22:24,183 - INFO - 保存断点至：./saved_models/checkpoints/epoch_0.pt
2025-08-24 19:22:24,183 - INFO - 
Epoch [2/3]
2025-08-24 19:22:48,434 - INFO - 评估完成 - 平均损失: 0.1866, 准确率: 0.9397
2025-08-24 19:22:49,920 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:22:49,921 - INFO - Iter:   1500, LR: 0.000032, Batch Train Loss:  0.11, Batch Train Acc: 96.88%, Val Loss:  0.19, Val Acc: 93.97%, Time: 0:06:20 *
2025-08-24 19:23:15,196 - INFO - 评估完成 - 平均损失: 0.1986, 准确率: 0.9350
2025-08-24 19:23:15,198 - INFO - Iter:   1600, LR: 0.000031, Batch Train Loss:  0.11, Batch Train Acc: 98.44%, Val Loss:   0.2, Val Acc: 93.50%, Time: 0:06:46 
2025-08-24 19:23:40,471 - INFO - 评估完成 - 平均损失: 0.1996, 准确率: 0.9387
2025-08-24 19:23:40,473 - INFO - Iter:   1700, LR: 0.000030, Batch Train Loss:  0.09, Batch Train Acc: 96.88%, Val Loss:   0.2, Val Acc: 93.87%, Time: 0:07:11 
2025-08-24 19:24:05,815 - INFO - 评估完成 - 平均损失: 0.1938, 准确率: 0.9371
2025-08-24 19:24:05,817 - INFO - Iter:   1800, LR: 0.000029, Batch Train Loss:   0.2, Batch Train Acc: 96.09%, Val Loss:  0.19, Val Acc: 93.71%, Time: 0:07:36 
2025-08-24 19:24:31,179 - INFO - 评估完成 - 平均损失: 0.1910, 准确率: 0.9390
2025-08-24 19:24:31,180 - INFO - Iter:   1900, LR: 0.000027, Batch Train Loss:  0.23, Batch Train Acc: 92.97%, Val Loss:  0.19, Val Acc: 93.90%, Time: 0:08:02 
2025-08-24 19:24:56,587 - INFO - 评估完成 - 平均损失: 0.1956, 准确率: 0.9391
2025-08-24 19:24:56,589 - INFO - Iter:   2000, LR: 0.000026, Batch Train Loss:  0.14, Batch Train Acc: 96.09%, Val Loss:   0.2, Val Acc: 93.91%, Time: 0:08:27 
2025-08-24 19:25:22,192 - INFO - 评估完成 - 平均损失: 0.1939, 准确率: 0.9407
2025-08-24 19:25:22,193 - INFO - Iter:   2100, LR: 0.000025, Batch Train Loss: 0.047, Batch Train Acc: 97.66%, Val Loss:  0.19, Val Acc: 94.07%, Time: 0:08:53 
2025-08-24 19:25:47,522 - INFO - 评估完成 - 平均损失: 0.1891, 准确率: 0.9399
2025-08-24 19:25:47,523 - INFO - Iter:   2200, LR: 0.000024, Batch Train Loss:  0.15, Batch Train Acc: 95.31%, Val Loss:  0.19, Val Acc: 93.99%, Time: 0:09:18 
2025-08-24 19:26:12,770 - INFO - 评估完成 - 平均损失: 0.2016, 准确率: 0.9375
2025-08-24 19:26:12,772 - INFO - Iter:   2300, LR: 0.000023, Batch Train Loss: 0.072, Batch Train Acc: 96.88%, Val Loss:   0.2, Val Acc: 93.75%, Time: 0:09:43 
2025-08-24 19:26:38,181 - INFO - 评估完成 - 平均损失: 0.1969, 准确率: 0.9390
2025-08-24 19:26:38,183 - INFO - Iter:   2400, LR: 0.000022, Batch Train Loss:   0.1, Batch Train Acc: 96.09%, Val Loss:   0.2, Val Acc: 93.90%, Time: 0:10:09 
2025-08-24 19:27:03,463 - INFO - 评估完成 - 平均损失: 0.1842, 准确率: 0.9417
2025-08-24 19:27:05,020 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:27:05,021 - INFO - Iter:   2500, LR: 0.000020, Batch Train Loss:  0.15, Batch Train Acc: 96.09%, Val Loss:  0.18, Val Acc: 94.17%, Time: 0:10:35 *
2025-08-24 19:27:30,335 - INFO - 评估完成 - 平均损失: 0.1824, 准确率: 0.9428
2025-08-24 19:27:31,907 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:27:31,908 - INFO - Iter:   2600, LR: 0.000019, Batch Train Loss:  0.13, Batch Train Acc: 94.53%, Val Loss:  0.18, Val Acc: 94.28%, Time: 0:11:02 *
2025-08-24 19:27:57,365 - INFO - 评估完成 - 平均损失: 0.1961, 准确率: 0.9398
2025-08-24 19:27:57,367 - INFO - Iter:   2700, LR: 0.000018, Batch Train Loss:  0.11, Batch Train Acc: 96.88%, Val Loss:   0.2, Val Acc: 93.98%, Time: 0:11:28 
2025-08-24 19:28:22,664 - INFO - 评估完成 - 平均损失: 0.1854, 准确率: 0.9432
2025-08-24 19:28:22,666 - INFO - Iter:   2800, LR: 0.000017, Batch Train Loss: 0.094, Batch Train Acc: 96.88%, Val Loss:  0.19, Val Acc: 94.32%, Time: 0:11:53 
2025-08-24 19:28:26,987 - INFO - 保存断点至：./saved_models/checkpoints/epoch_1.pt
2025-08-24 19:28:26,987 - INFO - 
Epoch [3/3]
2025-08-24 19:28:50,094 - INFO - 评估完成 - 平均损失: 0.2004, 准确率: 0.9412
2025-08-24 19:28:50,096 - INFO - Iter:   2900, LR: 0.000016, Batch Train Loss:  0.14, Batch Train Acc: 95.31%, Val Loss:   0.2, Val Acc: 94.12%, Time: 0:12:21 
2025-08-24 19:29:15,326 - INFO - 评估完成 - 平均损失: 0.2035, 准确率: 0.9415
2025-08-24 19:29:15,328 - INFO - Iter:   3000, LR: 0.000014, Batch Train Loss: 0.085, Batch Train Acc: 97.66%, Val Loss:   0.2, Val Acc: 94.15%, Time: 0:12:46 
2025-08-24 19:29:40,483 - INFO - 评估完成 - 平均损失: 0.2048, 准确率: 0.9408
2025-08-24 19:29:40,485 - INFO - Iter:   3100, LR: 0.000013, Batch Train Loss:  0.13, Batch Train Acc: 94.53%, Val Loss:   0.2, Val Acc: 94.08%, Time: 0:13:11 
2025-08-24 19:30:05,694 - INFO - 评估完成 - 平均损失: 0.1999, 准确率: 0.9412
2025-08-24 19:30:05,696 - INFO - Iter:   3200, LR: 0.000012, Batch Train Loss: 0.067, Batch Train Acc: 97.66%, Val Loss:   0.2, Val Acc: 94.12%, Time: 0:13:36 
2025-08-24 19:30:30,849 - INFO - 评估完成 - 平均损失: 0.2013, 准确率: 0.9422
2025-08-24 19:30:30,850 - INFO - Iter:   3300, LR: 0.000011, Batch Train Loss: 0.016, Batch Train Acc: 100.00%, Val Loss:   0.2, Val Acc: 94.22%, Time: 0:14:01 
2025-08-24 19:30:56,348 - INFO - 评估完成 - 平均损失: 0.1945, 准确率: 0.9430
2025-08-24 19:30:56,350 - INFO - Iter:   3400, LR: 0.000010, Batch Train Loss: 0.038, Batch Train Acc: 97.66%, Val Loss:  0.19, Val Acc: 94.30%, Time: 0:14:27 
2025-08-24 19:31:21,539 - INFO - 评估完成 - 平均损失: 0.2017, 准确率: 0.9422
2025-08-24 19:31:21,541 - INFO - Iter:   3500, LR: 0.000009, Batch Train Loss: 0.013, Batch Train Acc: 99.22%, Val Loss:   0.2, Val Acc: 94.22%, Time: 0:14:52 
2025-08-24 19:31:46,851 - INFO - 评估完成 - 平均损失: 0.1971, 准确率: 0.9442
2025-08-24 19:31:46,853 - INFO - Iter:   3600, LR: 0.000007, Batch Train Loss: 0.087, Batch Train Acc: 97.66%, Val Loss:   0.2, Val Acc: 94.42%, Time: 0:15:17 
2025-08-24 19:31:46,855 - INFO - TensorBoard writer已关闭
2025-08-24 19:31:46,861 - INFO - 清理临时紧急断点：./saved_models/checkpoints/emergency.pt
2025-08-24 19:31:46,862 - INFO - ===== 训练流程结束 =====
2025-08-24 19:31:46,863 - INFO - ===== 训练完成，开始测试集最终评估 =====
2025-08-24 19:34:39,452 - INFO - 随机种子已固定：42
2025-08-24 19:34:41,091 - INFO - 初始化数据迭代器耗时: 0:00:00
2025-08-24 19:34:41,091 - INFO - 训练集批次：1407，验证集批次：79，测试集批次：79
2025-08-24 19:34:41,091 - INFO - 从头训练（使用预训练模型初始化）
2025-08-24 19:34:41,091 - INFO - 
===== 开始训练 =====
2025-08-24 19:34:41,097 - INFO - 
Epoch [1/3]
2025-08-24 19:34:47,866 - INFO - 评估完成 - 平均损失: 2.2278, 准确率: 0.1955
2025-08-24 19:34:49,620 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:34:49,621 - INFO - Iter:      0, LR: 0.000050, Batch Train Loss:   2.5, Batch Train Acc:  7.81%, Val Loss:   2.2, Val Acc: 19.55%, Time: 0:00:09 *
2025-08-24 19:35:12,864 - INFO - 评估完成 - 平均损失: 0.3395, 准确率: 0.9010
2025-08-24 19:35:14,363 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:35:14,364 - INFO - Iter:    100, LR: 0.000049, Batch Train Loss:  0.48, Batch Train Acc: 88.28%, Val Loss:  0.34, Val Acc: 90.10%, Time: 0:00:33 *
2025-08-24 19:35:37,487 - INFO - 评估完成 - 平均损失: 0.3080, 准确率: 0.9064
2025-08-24 19:35:38,995 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:35:38,996 - INFO - Iter:    200, LR: 0.000048, Batch Train Loss:  0.37, Batch Train Acc: 89.84%, Val Loss:  0.31, Val Acc: 90.64%, Time: 0:00:58 *
2025-08-24 19:36:02,252 - INFO - 评估完成 - 平均损失: 0.2735, 准确率: 0.9147
2025-08-24 19:36:03,760 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:36:03,761 - INFO - Iter:    300, LR: 0.000046, Batch Train Loss:  0.22, Batch Train Acc: 92.97%, Val Loss:  0.27, Val Acc: 91.47%, Time: 0:01:23 *
2025-08-24 19:36:26,877 - INFO - 评估完成 - 平均损失: 0.2700, 准确率: 0.9144
2025-08-24 19:36:28,395 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:36:28,396 - INFO - Iter:    400, LR: 0.000045, Batch Train Loss:  0.21, Batch Train Acc: 92.97%, Val Loss:  0.27, Val Acc: 91.44%, Time: 0:01:47 *
2025-08-24 19:36:51,585 - INFO - 评估完成 - 平均损失: 0.2458, 准确率: 0.9200
2025-08-24 19:36:53,112 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:36:53,112 - INFO - Iter:    500, LR: 0.000044, Batch Train Loss:  0.26, Batch Train Acc: 92.19%, Val Loss:  0.25, Val Acc: 92.00%, Time: 0:02:12 *
2025-08-24 19:37:16,368 - INFO - 评估完成 - 平均损失: 0.2338, 准确率: 0.9220
2025-08-24 19:37:17,836 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:37:17,837 - INFO - Iter:    600, LR: 0.000043, Batch Train Loss:  0.25, Batch Train Acc: 92.19%, Val Loss:  0.23, Val Acc: 92.20%, Time: 0:02:37 *
2025-08-24 19:37:41,095 - INFO - 评估完成 - 平均损失: 0.2219, 准确率: 0.9277
2025-08-24 19:37:42,726 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:37:42,726 - INFO - Iter:    700, LR: 0.000042, Batch Train Loss:  0.25, Batch Train Acc: 92.97%, Val Loss:  0.22, Val Acc: 92.77%, Time: 0:03:02 *
2025-08-24 19:38:06,149 - INFO - 评估完成 - 平均损失: 0.2168, 准确率: 0.9291
2025-08-24 19:38:07,725 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:38:07,726 - INFO - Iter:    800, LR: 0.000041, Batch Train Loss:  0.21, Batch Train Acc: 96.09%, Val Loss:  0.22, Val Acc: 92.91%, Time: 0:03:27 *
2025-08-24 19:38:30,963 - INFO - 评估完成 - 平均损失: 0.2062, 准确率: 0.9319
2025-08-24 19:38:32,468 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:38:32,469 - INFO - Iter:    900, LR: 0.000039, Batch Train Loss:  0.32, Batch Train Acc: 90.62%, Val Loss:  0.21, Val Acc: 93.19%, Time: 0:03:51 *
2025-08-24 19:38:55,827 - INFO - 评估完成 - 平均损失: 0.2122, 准确率: 0.9291
2025-08-24 19:38:55,828 - INFO - Iter:   1000, LR: 0.000038, Batch Train Loss:  0.24, Batch Train Acc: 92.97%, Val Loss:  0.21, Val Acc: 92.91%, Time: 0:04:15 
2025-08-24 19:39:19,050 - INFO - 评估完成 - 平均损失: 0.1991, 准确率: 0.9313
2025-08-24 19:39:20,674 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:39:20,674 - INFO - Iter:   1100, LR: 0.000037, Batch Train Loss: 0.088, Batch Train Acc: 96.88%, Val Loss:   0.2, Val Acc: 93.13%, Time: 0:04:40 *
2025-08-24 19:39:44,025 - INFO - 评估完成 - 平均损失: 0.1945, 准确率: 0.9358
2025-08-24 19:39:45,580 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:39:45,581 - INFO - Iter:   1200, LR: 0.000036, Batch Train Loss:  0.28, Batch Train Acc: 92.19%, Val Loss:  0.19, Val Acc: 93.58%, Time: 0:05:04 *
2025-08-24 19:40:08,854 - INFO - 评估完成 - 平均损失: 0.1907, 准确率: 0.9360
2025-08-24 19:40:10,355 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:40:10,356 - INFO - Iter:   1300, LR: 0.000035, Batch Train Loss:  0.12, Batch Train Acc: 94.53%, Val Loss:  0.19, Val Acc: 93.60%, Time: 0:05:29 *
2025-08-24 19:40:33,786 - INFO - 评估完成 - 平均损失: 0.1995, 准确率: 0.9344
2025-08-24 19:40:33,788 - INFO - Iter:   1400, LR: 0.000033, Batch Train Loss:  0.16, Batch Train Acc: 96.88%, Val Loss:   0.2, Val Acc: 93.44%, Time: 0:05:53 
2025-08-24 19:40:36,744 - INFO - 保存断点至：./saved_models/checkpoints/epoch_0.pt
2025-08-24 19:40:36,745 - INFO - 
Epoch [2/3]
2025-08-24 19:41:01,122 - INFO - 评估完成 - 平均损失: 0.1866, 准确率: 0.9397
2025-08-24 19:41:02,623 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:41:02,624 - INFO - Iter:   1500, LR: 0.000032, Batch Train Loss:  0.11, Batch Train Acc: 96.88%, Val Loss:  0.19, Val Acc: 93.97%, Time: 0:06:22 *
2025-08-24 19:41:27,751 - INFO - 评估完成 - 平均损失: 0.1986, 准确率: 0.9350
2025-08-24 19:41:27,753 - INFO - Iter:   1600, LR: 0.000031, Batch Train Loss:  0.11, Batch Train Acc: 98.44%, Val Loss:   0.2, Val Acc: 93.50%, Time: 0:06:47 
2025-08-24 19:41:53,107 - INFO - 评估完成 - 平均损失: 0.1996, 准确率: 0.9387
2025-08-24 19:41:53,108 - INFO - Iter:   1700, LR: 0.000030, Batch Train Loss:  0.09, Batch Train Acc: 96.88%, Val Loss:   0.2, Val Acc: 93.87%, Time: 0:07:12 
2025-08-24 19:42:18,439 - INFO - 评估完成 - 平均损失: 0.1938, 准确率: 0.9371
2025-08-24 19:42:18,441 - INFO - Iter:   1800, LR: 0.000029, Batch Train Loss:   0.2, Batch Train Acc: 96.09%, Val Loss:  0.19, Val Acc: 93.71%, Time: 0:07:37 
2025-08-24 19:42:43,980 - INFO - 评估完成 - 平均损失: 0.1910, 准确率: 0.9390
2025-08-24 19:42:43,981 - INFO - Iter:   1900, LR: 0.000027, Batch Train Loss:  0.23, Batch Train Acc: 92.97%, Val Loss:  0.19, Val Acc: 93.90%, Time: 0:08:03 
2025-08-24 19:43:09,363 - INFO - 评估完成 - 平均损失: 0.1956, 准确率: 0.9391
2025-08-24 19:43:09,366 - INFO - Iter:   2000, LR: 0.000026, Batch Train Loss:  0.14, Batch Train Acc: 96.09%, Val Loss:   0.2, Val Acc: 93.91%, Time: 0:08:28 
2025-08-24 19:43:35,011 - INFO - 评估完成 - 平均损失: 0.1939, 准确率: 0.9407
2025-08-24 19:43:35,012 - INFO - Iter:   2100, LR: 0.000025, Batch Train Loss: 0.047, Batch Train Acc: 97.66%, Val Loss:  0.19, Val Acc: 94.07%, Time: 0:08:54 
2025-08-24 19:44:00,296 - INFO - 评估完成 - 平均损失: 0.1891, 准确率: 0.9399
2025-08-24 19:44:00,297 - INFO - Iter:   2200, LR: 0.000024, Batch Train Loss:  0.15, Batch Train Acc: 95.31%, Val Loss:  0.19, Val Acc: 93.99%, Time: 0:09:19 
2025-08-24 19:44:25,849 - INFO - 评估完成 - 平均损失: 0.2016, 准确率: 0.9375
2025-08-24 19:44:25,851 - INFO - Iter:   2300, LR: 0.000023, Batch Train Loss: 0.072, Batch Train Acc: 96.88%, Val Loss:   0.2, Val Acc: 93.75%, Time: 0:09:45 
2025-08-24 19:44:51,239 - INFO - 评估完成 - 平均损失: 0.1969, 准确率: 0.9390
2025-08-24 19:44:51,241 - INFO - Iter:   2400, LR: 0.000022, Batch Train Loss:   0.1, Batch Train Acc: 96.09%, Val Loss:   0.2, Val Acc: 93.90%, Time: 0:10:10 
2025-08-24 19:45:16,555 - INFO - 评估完成 - 平均损失: 0.1842, 准确率: 0.9417
2025-08-24 19:45:18,084 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:45:18,085 - INFO - Iter:   2500, LR: 0.000020, Batch Train Loss:  0.15, Batch Train Acc: 96.09%, Val Loss:  0.18, Val Acc: 94.17%, Time: 0:10:37 *
2025-08-24 19:45:43,176 - INFO - 评估完成 - 平均损失: 0.1824, 准确率: 0.9428
2025-08-24 19:45:44,701 - INFO - 最佳模型已更新，保存至：./saved_models/model/best_model.pth
2025-08-24 19:45:44,702 - INFO - Iter:   2600, LR: 0.000019, Batch Train Loss:  0.13, Batch Train Acc: 94.53%, Val Loss:  0.18, Val Acc: 94.28%, Time: 0:11:04 *
2025-08-24 19:46:10,197 - INFO - 评估完成 - 平均损失: 0.1961, 准确率: 0.9398
2025-08-24 19:46:10,199 - INFO - Iter:   2700, LR: 0.000018, Batch Train Loss:  0.11, Batch Train Acc: 96.88%, Val Loss:   0.2, Val Acc: 93.98%, Time: 0:11:29 
2025-08-24 19:46:35,389 - INFO - 评估完成 - 平均损失: 0.1854, 准确率: 0.9432
2025-08-24 19:46:35,391 - INFO - Iter:   2800, LR: 0.000017, Batch Train Loss: 0.094, Batch Train Acc: 96.88%, Val Loss:  0.19, Val Acc: 94.32%, Time: 0:11:54 
2025-08-24 19:46:42,707 - INFO - 保存断点至：./saved_models/checkpoints/epoch_1.pt
2025-08-24 19:46:42,708 - INFO - 
Epoch [3/3]
2025-08-24 19:47:05,657 - INFO - 评估完成 - 平均损失: 0.2004, 准确率: 0.9412
2025-08-24 19:47:05,659 - INFO - Iter:   2900, LR: 0.000016, Batch Train Loss:  0.14, Batch Train Acc: 95.31%, Val Loss:   0.2, Val Acc: 94.12%, Time: 0:12:25 
2025-08-24 19:47:30,859 - INFO - 评估完成 - 平均损失: 0.2035, 准确率: 0.9415
2025-08-24 19:47:30,861 - INFO - Iter:   3000, LR: 0.000014, Batch Train Loss: 0.085, Batch Train Acc: 97.66%, Val Loss:   0.2, Val Acc: 94.15%, Time: 0:12:50 
2025-08-24 19:47:56,274 - INFO - 评估完成 - 平均损失: 0.2048, 准确率: 0.9408
2025-08-24 19:47:56,276 - INFO - Iter:   3100, LR: 0.000013, Batch Train Loss:  0.13, Batch Train Acc: 94.53%, Val Loss:   0.2, Val Acc: 94.08%, Time: 0:13:15 
2025-08-24 19:48:21,622 - INFO - 评估完成 - 平均损失: 0.1999, 准确率: 0.9412
2025-08-24 19:48:21,624 - INFO - Iter:   3200, LR: 0.000012, Batch Train Loss: 0.067, Batch Train Acc: 97.66%, Val Loss:   0.2, Val Acc: 94.12%, Time: 0:13:41 
2025-08-24 19:48:47,027 - INFO - 评估完成 - 平均损失: 0.2013, 准确率: 0.9422
2025-08-24 19:48:47,029 - INFO - Iter:   3300, LR: 0.000011, Batch Train Loss: 0.016, Batch Train Acc: 100.00%, Val Loss:   0.2, Val Acc: 94.22%, Time: 0:14:06 
2025-08-24 19:49:12,750 - INFO - 评估完成 - 平均损失: 0.1945, 准确率: 0.9430
2025-08-24 19:49:12,752 - INFO - Iter:   3400, LR: 0.000010, Batch Train Loss: 0.038, Batch Train Acc: 97.66%, Val Loss:  0.19, Val Acc: 94.30%, Time: 0:14:32 
2025-08-24 19:49:38,201 - INFO - 评估完成 - 平均损失: 0.2017, 准确率: 0.9422
2025-08-24 19:49:38,202 - INFO - Iter:   3500, LR: 0.000009, Batch Train Loss: 0.013, Batch Train Acc: 99.22%, Val Loss:   0.2, Val Acc: 94.22%, Time: 0:14:57 
2025-08-24 19:50:03,732 - INFO - 评估完成 - 平均损失: 0.1971, 准确率: 0.9442
2025-08-24 19:50:03,734 - INFO - Iter:   3600, LR: 0.000007, Batch Train Loss: 0.087, Batch Train Acc: 97.66%, Val Loss:   0.2, Val Acc: 94.42%, Time: 0:15:23 
2025-08-24 19:50:03,736 - INFO - TensorBoard writer已关闭
2025-08-24 19:50:03,736 - INFO - ===== 训练流程结束 =====
2025-08-24 19:50:03,737 - INFO - ===== 训练完成，开始测试集最终评估 =====
2025-08-24 19:50:04,039 - INFO - 已加载最佳模型：./saved_models/model/best_model.pth
2025-08-24 19:50:10,180 - INFO - 评估完成 - 平均损失: 0.1671, 准确率: 0.9482
2025-08-24 19:50:10,195 - INFO - Test Loss:  0.17, Test Acc: 94.82%
2025-08-24 19:50:10,195 - INFO - Precision, Recall and F1-Score...
2025-08-24 19:50:10,195 - INFO -                precision    recall  f1-score   support

      finance     0.9474    0.9180    0.9325      1000
       realty     0.9560    0.9570    0.9565      1000
       stocks     0.9168    0.9040    0.9104      1000
    education     0.9739    0.9690    0.9714      1000
      science     0.9328    0.9160    0.9243      1000
      society     0.9347    0.9440    0.9393      1000
     politics     0.9142    0.9380    0.9260      1000
       sports     0.9792    0.9910    0.9851      1000
         game     0.9768    0.9670    0.9719      1000
entertainment     0.9504    0.9780    0.9640      1000

     accuracy                         0.9482     10000
    macro avg     0.9482    0.9482    0.9481     10000
 weighted avg     0.9482    0.9482    0.9481     10000

2025-08-24 19:50:10,195 - INFO - Confusion Matrix...
2025-08-24 19:50:10,196 - INFO - 
[[918  13  39   1   3   4  18   2   1   1]
 [ 10 957   5   1   4   4   7   2   1   9]
 [ 35  13 904   0  17   2  26   2   0   1]
 [  0   0   0 969   3  12   6   0   0  10]
 [  0   1  19   3 916  17  14   3  17  10]
 [  3  13   1  11   2 944  13   0   3  10]
 [  3   3  15   8   7  22 938   1   0   3]
 [  0   1   1   0   0   2   1 991   0   4]
 [  0   0   1   1  25   1   1   1 967   3]
 [  0   0   1   1   5   2   2  10   1 978]]
2025-08-24 19:50:10,196 - INFO - Time usage: 0:00:06
2025-08-24 19:50:10,196 - INFO - 训练+评估+测试流程全部完成！
2025-08-24 19:52:28,351 - INFO - 随机种子已固定：42
2025-08-24 19:52:29,954 - INFO - 成功加载模型：./saved_models/model/best_model.pth
2025-08-24 19:52:29,955 - INFO - 交互演示模式（输入q退出）
2025-08-24 19:54:14,302 - INFO - 随机种子已固定：42
2025-08-24 19:54:15,502 - INFO - 
===== 启动批量预测模式 =====
2025-08-24 19:54:15,943 - INFO - 成功加载模型：./saved_models/model/best_model.pth
2025-08-24 19:54:16,156 - INFO - 批量预测完成，结果已保存至：./data/output/output.txt
